<div class="container">
    <div class="row my-2">
        <div class="col-10">
            <select class="form-control" ng-model="selected_user" ng-options="user as user.firstname for user in users_list" ng-change="selectUser()">
                <option value="">-- See the interface as user --</option>
            </select>
        </div>
        <div class="col-2">
            <button type="button" class="btn btn-outline-success btn-block" ng-click="show_new_user_form = true"><span class="oi oi-plus"></span> user</button>
        </div>
    </div>
    <form class="form" ng-show="show_new_user_form" ng-submit="addUser()">
        <div class="form-group row">
            <div class="col-2">
                <input type="text" ng-model="new_user_pseudo" class="form-control form-control-sm" placeholder="Pseudo *" required>
            </div>
            <div class="col-2">
                <input type="text" ng-model="new_user_firstname" class="form-control form-control-sm" placeholder="First name">
            </div>
            <div class="col-2">
                <input type="text" ng-model="new_user_lastname" class="form-control form-control-sm" placeholder="Last name">
            </div>
            <div class="col-3">
                <input type="text" ng-model="new_user_email" class="form-control form-control-sm" placeholder="Email *" required>
            </div>
            <div class="col-2">
                <input type="text" ng-model="new_user_password" class="form-control form-control-sm" placeholder="Password *" required>
            </div>
            <div class="col-1">
                <button type="submit" class="btn btn-sm btn-success"><span class="oi oi-check"></span></button>
            </div>
        </div>
    </form>
    <div class="row" ng-show="selected_user">
        <div class="col-12 mb-2">
            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <a href="#" class="nav-link" ng-click="view = 'tasks'"><span class="oi oi-data-transfer-download"></span> Tasks</a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" ng-click="view = 'quashs'"><span class="oi oi-data-transfer-upload"></span> Quashs</a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" ng-click="view = 'skills'"><span class="oi oi-cog"></span> Skills</a>
                </li>
            </ul>
        </div>


        <div class="col-12" ng-show="view == 'skills'">
            <h5 class="text-info">Skills</h5>
            <div ng-repeat="skill in selected_user.skills_list">
                <h5>
                    <button type="button" class="btn btn-sm btn-info" ng-click="removeUserSkill(skill)"><span class="oi oi-trash"></span></button> {{skill.name}}
                </h5>
                <p>{{skill.text}}</p>
            </div>
            <button type="button" class="btn btn-sm btn-info" ng-click="show_user_skill_form = !show_user_skill_form"><span class="oi oi-plus"></span> skill</button>
            <form class="form small" ng-submit="addUserSkill()" ng-show="show_user_skill_form">
                <div class="row form-group my-2">
                    <div class="col-4">
                        <select class="form-control form-control-sm" ng-model="selected_skill" ng-options="skill as skill.name for skill in all_skills_list"></select>
                    </div>
                    <div class="col-6">
                        <input type="text" class="form-control form-control-sm" ng-model="text" placeholder="Description of my skill that will appear in my profile" required>
                    </div>
                    <div class="col-2">
                        <input type="submit" class="btn btn-sm btn-success" value="Add"/>
                    </div>
                    <div class="col-12">
                        <button type="button" class="btn btn-sm" ng-click="show_new_skill_form = true">Create a new one</button>
                    </div>
                </div>
            </form>
            <form class="form small" ng-submit="addSkill()" ng-show="show_new_skill_form">
                <div class="row form-group my-2">
                    <div class="col-4">
                        <input type="text" class="form-control form-control-sm" ng-model="skill_name" placeholder="Name" required>
                    </div>
                    <div class="col-8">
                        <input type="submit" class="btn btn-sm btn-success" value="Create"/>
                    </div>
                </div>
            </form>
        </div>


        <div class="col-12" ng-show="view == 'tasks'">
            <h5 class="text-primary">
                Tasks submitted
                <button type="button" class="btn btn-sm btn-primary" ng-click="show_user_task_form = !show_user_task_form"><span class="oi oi-plus"></span> task</button>
            </h5>
            <div ng-repeat="task in selected_user.tasks_list" class="card my-2">
                <div class="card-header">
                    <div class="row">
                        <div class="col-4">
                            Task {{task.id}}
                        </div>
                        <div class="col-4" ng-hide="task.status == 'quasher_accepted'">
                            {{task.offers.length}} candidates
                        </div>
                        <div class="col-4" ng-show="task.status == 'quasher_accepted'">
                            Candidate hired
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <p class="h5">{{task.description}}</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-3">
                            <span class="oi" ng-class="task.status == 'quasher_accepted' ? 'oi-lock-locked' : 'oi-lock-unlocked'"></span>
                            <span class="badge">{{task.status}}</span>
                        </div>
                        <div class="col-3">
                            <span class="oi oi-clock"></span> {{task.datetime_creation}}
                        </div>
                        <div class="col-3">
                            <span class="oi oi-dollar"></span> {{task.reward}}
                        </div>
                        <div class="col-3">
                            <span class="oi oi-compass"></span> Range
                        </div>
                    </div>
                </div>
                <div class="card-body" ng-show="task.status == 'quasher_accepted'">
                    <div class="row">
                        <div class="col-1">
                            <img ng-src="{{task.quasher.photo}}" class="img-fluid rounded" alt="">
                        </div>
                        <div class="col-11">
                            <p class="h5">Task is for {{task.quasher.firstname}}</p>
                        </div>
                    </div>
                </div>
                <div class="card-body" ng-show="task.status == 'quasher_pending'">
                    <div class="row my-2" ng-repeat="offer in task.offers">
                        <div class="col-1">
                            <img ng-src="{{offer.photo}}" class="img-fluid rounded" alt="">
                        </div>
                        <div class="col-11">
                            <p class="h5">{{offer.firstname}} <button type="button" class="btn btn-sm btn-success" ng-click="acceptOffer(offer)"><span class="oi oi-thumb-up"></span> Hire</button></p>
                        </div>
                    </div>
                </div>
            </div>

            <form class="form small" ng-submit="addUserTask()" ng-show="show_user_task_form">
                <div class="row form-group my-2">
                    <div class="col-3">
                        <label>Title</label>
                        <input type="text" class="form-control form-control-sm" ng-model="title" placeholder="Task title" required>
                    </div>
                    <div class="col-3">
                        <label>Deadline</label>
                        <input type="date" class="form-control form-control-sm" ng-model="deadline" required>
                    </div>
                    <div class="col-3">
                        <label>Category</label>
                        <select class="form-control form-control-sm" ng-model="selected_skill" ng-options="skill as skill.name for skill in all_skills_list"></select>
                    </div>
                    <div class="col-3">
                        <label>Distance (km)</label>
                        <input type="number" class="form-control form-control-sm" ng-model="distance" placeholder="1">
                    </div>
                    <div class="col-12">
                        <label>Description</label>
                        <input type="text" class="form-control form-control-sm" ng-model="description" placeholder="Description" required>
                    </div>
                    <div class="col-2">
                        <input type="submit" class="btn btn-sm btn-success" value="Add"/>
                    </div>
                </div>
            </form>
        </div>


        <div class="col-12" ng-show="view == 'quashs'">
            <h5 class="text-success">Possible quashs <small>based on your skills</small></h5>
            <div class="row" ng-show="selected_user.interesting_quashs_list.length > 0">
                <div class="col-12">
                    <div class="alert alert-success">
                        There are {{selected_user.interesting_quashs_list.length}} new quashs that could interest you.
                        <button type="button" class="btn btn-outline-success" ng-click="show_new_interesting_quashs = !show_new_interesting_quashs"><span class="oi oi-eye"></span> See</button>
                    </div>
                </div>
            </div>
            <div class="card border-success mb-2" ng-repeat="interesting_quash in selected_user.interesting_quashs_list" ng-show="show_new_interesting_quashs">
                <div class="card-header">
                    <div class="row">
                        <div class="col-12">
                            <p class="h5">{{interesting_quash.description}}</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-1">
                            <img ng-src="{{interesting_quash.taskmaster.photo}}" class="img-fluid rounded" alt="">
                        </div>
                        <div class="col-11">
                            created by <span class="badge">{{interesting_quash.taskmaster.pseudo}}</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-3">
                            <span class="oi" ng-class="interesting_quash.status == 'quasher_accepted' ? 'oi-lock-locked' : 'oi-lock-unlocked'"></span>
                            <span class="badge">{{interesting_quash.status}}</span>
                        </div>
                        <div class="col-3">
                            <span class="oi oi-clock"></span> {{interesting_quash.datetime_creation}}
                        </div>
                        <div class="col-3">
                            <span class="oi oi-dollar"></span> {{interesting_quash.reward}}
                        </div>
                        <div class="col-3" ng-show="interesting_quash.status == 'quasher_accepted'">
                            <span class="oi oi-thumb-up"></span> Hired
                        </div>
                    </div>
                </div>
                <div class="card-body" ng-show="interesting_quash.status == 'created'">
                    <div class="row my-2">
                        <div class="col-12">
                            <button type="button" class="btn btn-outline-success" ng-click="makeQuashApplication(quash)"><span class="oi oi-check"></span> Accept to do this task</button>
                        </div>
                    </div>
                </div>
            </div>
            <div ng-repeat="quash in selected_user.possible_quashs_list" class="card my-2" ng-show="quash.status != 'created'">
                <div class="card-header">
                    <div class="row">
                        <div class="col-12">
                            <p class="h5">{{quash.description}}</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <span class="oi oi-person"></span> created by <span class="badge">{{quash.taskmaster.pseudo}}</span>
                        </div>
                        <div class="col-3">
                            <span class="oi" ng-class="quash.status == 'quasher_accepted' ? 'oi-lock-locked' : 'oi-lock-unlocked'"></span>
                            <span class="badge">{{quash.status}}</span>
                        </div>
                        <div class="col-3">
                            <span class="oi oi-clock"></span> {{quash.datetime_creation}}
                        </div>
                        <div class="col-3">
                            <span class="oi oi-dollar"></span> {{quash.reward}}
                        </div>
                        <div class="col-3" ng-show="quash.status == 'quasher_accepted'">
                            <span class="oi oi-thumb-up"></span> Hired
                        </div>
                    </div>
                </div>
                <div class="card-body" ng-show="quash.status == 'quasher_accepted'">
                    <div class="row">
                        <div class="col-1">
                            <img ng-src="{{quash.taskmaster.photo}}" class="img-fluid rounded" alt="">
                        </div>
                        <div class="col-11">
                            <p class="h5">Conversation with {{quash.taskmaster.firstname}}</p>
                            <p class="">my conversation with {{quash.taskmaster.firstname}} will soon appear when the chat will be developped</p>
                        </div>
                    </div>
                    <button type="button" class="btn btn-sm btn-success" ng-click="makeQuashApplication(quash)" ng-show="quash.already_applied != true && (quash.status == 'created' || quash.status == 'quasher_pending')"><span class="oi oi-thumb-up"></span> I can do it!</button>
                </div>
                <div class="card-body" ng-show="quash.status == 'quasher_pending'">
                    <div class="row my-2" ng-repeat="offer in quash.offers">
                        <div class="col-1">
                            <img ng-src="{{offer.photo}}" class="img-fluid rounded" alt="">
                        </div>
                        <div class="col-11">
                            <p class="h5">{{offer.firstname}}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
